import React, { useState, useEffect } from 'react'
import * as tf from '@tensorflow/tfjs'

interface Props {}

const Home: React.FC<Props> = () => {
  const [image, setImage] = useState<string | null>(null)
  const [text, setText] = useState('')

  useEffect(() => {
    async function loadModel() {
      const model = await tf.automl.loadObjectDetection('model/model.json')
      setText(await model.extractText(image))
    }

    if (image) {
      loadModel()
    }
  }, [image])

  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const uploadedImage = e.target.files![0]
    setImage(URL.createObjectURL(uploadedImage))
  }

  return (
    <div>
      <input type="file" onChange={handleImageUpload} />
      {image && <img src={image} />}
      <p>{text}</p>
    </div>
  )
}

export default Home